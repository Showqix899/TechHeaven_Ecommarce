{% extends "layout.html" %}

{% block title %}Payment List{% endblock %}

{% block content %}
<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-lg-10 mb-2 mt-2">
      <form class="d-flex" role="search by email" method="GET" action="{% url 'payment_list' %}">
            {% csrf_token %}
            <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search" value="{{ query }}" name="query"/>
            <button class="btn btn-outline-success" type="submit">Search</button>
      </form>
    </div>



      <!-- Header -->
      <div class="mb-4 text-center">
        <h3>All Payments</h3>
        <p class="text-muted">
          Total Sell Amount: <strong>{{ total_order_amount }} BDT</strong>
        </p>
        <hr>
      </div>

      <!-- Payment List -->
      {% for payment in orders_item %}
        <div class="card mb-3 shadow-sm rounded-3">
          <div class="card-body">
            <h5 class="card-title">Payment ID: {{ payment.id }}</h5>
            <p class="mb-1"><strong>User:</strong> {{ payment.user.email }}</p>
            <p class="mb-1"><strong>Total:</strong> {{ payment.total_amount }} BDT</p>
            <p class="mb-1"><strong>Method:</strong> {{ payment.payment_method }}</p>
            <p class="mb-0 text-muted"><small>{{ payment.created_at }}</small></p>
          </div>
        </div>
      {% empty %}
        <p class="text-center text-muted">No payments found.</p>
      {% endfor %}

      <!-- Pagination -->
      {% if page_obj.paginator.num_pages > 1 %}
        <nav aria-label="Page navigation">
          <ul class="pagination justify-content-center">
            {% if page_obj.has_previous %}
              <li class="page-item">
                <a class="page-link" href="?page={{ page_obj.previous_page_number }}">Previous</a>
              </li>
            {% endif %}

            {% for num in page_obj.paginator.page_range %}
              <li class="page-item {% if page_obj.number == num %}active{% endif %}">
                <a class="page-link" href="?page={{ num }}">{{ num }}</a>
              </li>
            {% endfor %}

            {% if page_obj.has_next %}
              <li class="page-item">
                <a class="page-link" href="?page={{ page_obj.next_page_number }}">Next</a>
              </li>
            {% endif %}
          </ul>
        </nav>
      {% endif %}

    </div>
  </div>
</div>
{% endblock %}
